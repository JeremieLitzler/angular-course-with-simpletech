<main>
  <aside class="preview">
    <app-playing-card [monster]="monster" />
  </aside>
  <section>
    <form [formGroup]="form" (submit)="submit($event)">
      <mat-form-field>
        <mat-label for="name">Name</mat-label>
        <input
          matInput
          id="name"
          name="name"
          type="text"
          formControlName="name"
        />
        @if (isFieldValid("name")) {
          <mat-error>This field is required</mat-error>
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label for="hp">HP</mat-label>
        <input matInput id="hp" name="hp" type="number" formControlName="hp" />
        @if (isFieldValid("hp")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label for="type">Type</mat-label>
        <mat-select id="type" name="type" type="number" formControlName="type">
          @for (type of monsterTypes; track type) {
            <mat-option [value]="type">{{ type }}</mat-option>
          }
        </mat-select>
        @if (isFieldValid("type")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>

      <mat-form-field>
        <mat-label for="attackName">Attack Name</mat-label>
        <input
          matInput
          id="attackName"
          name="attackName"
          type="text"
          formControlName="attackName"
        />
        @if (isFieldValid("attackName")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label for="attackStrength">Attack Strength</mat-label>
        <input
          matInput
          id="attackStrength"
          name="attackStrength"
          type="number"
          formControlName="attackStrength"
        />
        @if (isFieldValid("attackStrength")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label for="attackDescription">Attack Description</mat-label>
        <input
          matInput
          id="attackDescription"
          name="attackDescription"
          type="text"
          formControlName="attackDescription"
        />
        @if (isFieldValid("attackDescription")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label for="figureCaption">Image Caption</mat-label>
        <input
          matInput
          id="figureCaption"
          name="figureCaption"
          type="text"
          formControlName="figureCaption"
        />
        @if (isFieldValid("figureCaption")) {
          <mat-error>This field is invalid</mat-error>
        }
      </mat-form-field>
      <div class="form-field">
        <button mat-raised-button type="button" (click)="imageInput.click()">
          {{ getUploadImageButtonLabel(imageInput) }}
        </button>
        <input
          #imageInput
          id="image"
          name="image"
          type="file"
          hidden
          (change)="onFileChange($event)"
        />
        @if (isFieldValid("image")) {
          <p class="error">This field is invalid</p>
        }
      </div>
      <div class="form-actions">
        <div class="form-actions-left">
          @if (monsterId()) {
            <button
              mat-flat-button
              color="warn"
              type="button"
              (click)="deleteMonster()"
            >
              Delete
            </button>
          }
        </div>
        <div class="form-actions-right">
          <button mat-flat-button type="submit" [disabled]="form.invalid">
            Save
          </button>
          <button mat-button (click)="navigateBack()">Back</button>
        </div>
      </div>
    </form>
  </section>
</main>
